

  ========= 测试开始 : 20230207_220922 =========



>>> cases\API\空白环境\

[ suite setup ] cases\API\空白环境\
suite_setup

-- 第 1 步 -- 清空所有学生/老师/班级 



>>> cases\API\空白环境\blank_test.py

* 添加班级1  -  2023-02-07 22:09:22

  [ case execution steps ]

-- 第 1 步 -- 添加班级 

接口返回0

** 检查点 **  检查返回值 ---->  通过

接口返回20424

** 检查点 **  检查返回值 ---->  通过

  PASS 


>>> cases\API\空白环境\存在班级\

[ suite setup ] cases\API\空白环境\存在班级\

-- 第 1 步 -- 添加班级 

old初始班级id:20425


>>> cases\API\空白环境\存在班级\excl_class.py

* 添加班级2  -  2023-02-07 22:09:25

  [ case execution steps ]

-- 第 1 步 -- 添加班级 

接口返回{'invitecode': '204266507092', 'retcode': 0, 'id': 20426}
接口返回0

** 检查点 **  检查返回值 ---->  通过

接口返回20426

** 检查点 **  检查返回结果 ---->  通过

  PASS 

* 添加班级3  -  2023-02-07 22:09:25

  [ case execution steps ]

-- 第 1 步 -- 添加相同名称的班级 

接口返回{'reason': 'Traceback (most recent call last):\n  File "/home/yjyx/yijiao_src/yijiao_main/services/datamodel/schoolclass/models.py", line 542, in addClass\n    school_class = self._addClass(name,schoolid,gradeid,studentlimit)\n  File "/home/yjyx/yijiao_src/yijiao_main/services/datamodel/schoolclass/models.py", line 531, in _addClass\n    school_class.save()\n  File "/usr/local/lib/python2.7/site-packages/django/db/models/base.py", line 710, in save\n    force_update=force_update, update_fields=update_fields)\n  File "/usr/local/lib/python2.7/site-packages/django/db/models/base.py", line 738, in save_base\n    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)\n  File "/usr/local/lib/python2.7/site-packages/django/db/models/base.py", line 822, in _save_table\n    result = self._do_insert(cls._base_manager, using, fields, update_pk, raw)\n  File "/usr/local/lib/python2.7/site-packages/django/db/models/base.py", line 861, in _do_insert\n    using=using, raw=raw)\n  File "/usr/local/lib/python2.7/site-packages/django/db/models/manager.py", line 127, in manager_method\n    return getattr(self.get_queryset(), name)(*args, **kwargs)\n  File "/usr/local/lib/python2.7/site-packages/django/db/models/query.py", line 920, in _insert\n    return query.get_compiler(using=using).execute_sql(return_id)\n  File "/usr/local/lib/python2.7/site-packages/django/db/models/sql/compiler.py", line 974, in execute_sql\n    cursor.execute(sql, params)\n  File "/usr/local/lib/python2.7/site-packages/django/db/backends/utils.py", line 64, in execute\n    return self.cursor.execute(sql, params)\n  File "/usr/local/lib/python2.7/site-packages/django/db/utils.py", line 97, in __exit__\n    six.reraise(dj_exc_type, dj_exc_value, traceback)\n  File "/usr/local/lib/python2.7/site-packages/django/db/backends/utils.py", line 64, in execute\n    return self.cursor.execute(sql, params)\n  File "/usr/local/lib/python2.7/site-packages/django/db/backends/mysql/base.py", line 124, in execute\n    return self.cursor.execute(query, args)\n  File "/usr/local/lib/python2.7/site-packages/MySQLdb/cursors.py", line 205, in execute\n    self.errorhandler(self, exc, value)\n  File "/usr/local/lib/python2.7/site-packages/MySQLdb/connections.py", line 36, in defaulterrorhandler\n    raise errorclass, errorvalue\nIntegrityError: (1062, "Duplicate entry \'\\xe5\\x88\\x9d\\xe5\\xa7\\x8b\\xe7\\x8f\\xad\\xe7\\xba\\xa7-407-1\' for key \'name\'")\n', 'retcode': 1}
接口返回Traceback (most recent call last):
  File "/home/yjyx/yijiao_src/yijiao_main/services/datamodel/schoolclass/models.py", line 542, in addClass
    school_class = self._addClass(name,schoolid,gradeid,studentlimit)
  File "/home/yjyx/yijiao_src/yijiao_main/services/datamodel/schoolclass/models.py", line 531, in _addClass
    school_class.save()
  File "/usr/local/lib/python2.7/site-packages/django/db/models/base.py", line 710, in save
    force_update=force_update, update_fields=update_fields)
  File "/usr/local/lib/python2.7/site-packages/django/db/models/base.py", line 738, in save_base
    updated = self._save_table(raw, cls, force_insert, force_update, using, update_fields)
  File "/usr/local/lib/python2.7/site-packages/django/db/models/base.py", line 822, in _save_table
    result = self._do_insert(cls._base_manager, using, fields, update_pk, raw)
  File "/usr/local/lib/python2.7/site-packages/django/db/models/base.py", line 861, in _do_insert
    using=using, raw=raw)
  File "/usr/local/lib/python2.7/site-packages/django/db/models/manager.py", line 127, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File "/usr/local/lib/python2.7/site-packages/django/db/models/query.py", line 920, in _insert
    return query.get_compiler(using=using).execute_sql(return_id)
  File "/usr/local/lib/python2.7/site-packages/django/db/models/sql/compiler.py", line 974, in execute_sql
    cursor.execute(sql, params)
  File "/usr/local/lib/python2.7/site-packages/django/db/backends/utils.py", line 64, in execute
    return self.cursor.execute(sql, params)
  File "/usr/local/lib/python2.7/site-packages/django/db/utils.py", line 97, in __exit__
    six.reraise(dj_exc_type, dj_exc_value, traceback)
  File "/usr/local/lib/python2.7/site-packages/django/db/backends/utils.py", line 64, in execute
    return self.cursor.execute(sql, params)
  File "/usr/local/lib/python2.7/site-packages/django/db/backends/mysql/base.py", line 124, in execute
    return self.cursor.execute(query, args)
  File "/usr/local/lib/python2.7/site-packages/MySQLdb/cursors.py", line 205, in execute
    self.errorhandler(self, exc, value)
  File "/usr/local/lib/python2.7/site-packages/MySQLdb/connections.py", line 36, in defaulterrorhandler
    raise errorclass, errorvalue
IntegrityError: (1062, "Duplicate entry '\xe5\x88\x9d\xe5\xa7\x8b\xe7\x8f\xad\xe7\xba\xa7-407-1' for key 'name'")


** 检查点 **  检查返回结果 ---->  !! 不通过!!

  FAIL    
Traceback:
  File "cases\API\空白环境\存在班级\excl_class.py", line 35, in teststeps
    CHECK_POINT('检查返回结果', reason == 'duplicated class name')
  File "D:\Python39\lib\site-packages\hytest\common.py", line 58, in CHECK_POINT
    raise AssertionError()
AssertionError


* 修改班级1  -  2023-02-07 22:09:25

  [ case execution steps ]

-- 第 1 步 -- 修改班级名字 


-- 第 2 步 -- 查询班级名称 


** 检查点 **  检查返回结果 ---->  通过

  PASS 

* 修改班级2  -  2023-02-07 22:09:25

  [ case execution steps ]

-- 第 1 步 -- 创建班级 

初始班级id:20428
  ABORT   list indices must be integers or slices, not str 
Traceback:
  File "cases\API\空白环境\存在班级\excl_class.py", line 63, in teststeps
    new_name = res_ls.json()['retlist']['name']
TypeError: list indices must be integers or slices, not str


* 修改班级3  -  2023-02-07 22:09:25

  [ case execution steps ]

-- 第 1 步 -- 修改不存在的班级 

修改返回结果:{'reason': 'id 为`99999999`的班级不存在', 'retcode': 404}

** 检查点 **  检查返回结果 ---->  通过

  PASS 

* 删除班级1  -  2023-02-07 22:09:25

  [ case execution steps ]

-- 第 1 步 -- 删除不存在的班级 

修改返回结果:{'reason': 'id 为`9999999`的班级不存在', 'retcode': 404}

** 检查点 **  检查返回结果 ---->  通过

  PASS 

* 删除班级2  -  2023-02-07 22:09:25

[ case setup ] 删除班级2

-- 第 1 步 -- 创建班级 


  [ case execution steps ]

-- 第 2 步 -- 删除班级 

修改返回结果:{'retcode': 0}

** 检查点 **  检查返回结果 ---->  !! 不通过!!

  FAIL    
Traceback:
  File "cases\API\空白环境\存在班级\excl_class.py", line 107, in teststeps
    CHECK_POINT('检查返回结果', retcode == '0')
  File "D:\Python39\lib\site-packages\hytest\common.py", line 58, in CHECK_POINT
    raise AssertionError()
AssertionError



>>> cases\API\空白环境\存在班级\excl_teacher.py

* 添加老师1  -  2023-02-07 22:09:25

  [ case execution steps ]

-- 第 1 步 -- 添加老师 

返回结果{'retcode': 0, 'id': 5384}

** 检查点 **  存在添加的老师 ---->  通过

  PASS 


>>> cases\API\空白环境\存在班级\存在老师\

[ suite setup ] cases\API\空白环境\存在班级\存在老师\

-- 第 1 步 -- 添加老师 

suite setup fail | 'id' 
Traceback:
  File "cases\API\空白环境\存在班级\存在老师\__st__.py", line 13, in suite_setup
    GSTORE['cste_id'] = ad_res.json()['id']
KeyError: 'id'



  ========= 测试结束 : 20230207_220925 =========


  耗时    : 3.878 秒


  预备执行用例数量 : 18

  实际执行用例数量 : 9

  通过 : 6

  失败 : 2

  异常 : 1

  套件初始化失败 : 1

  套件清除  失败 : 0

  用例初始化失败 : 0

  用例清除  失败 : 0
